---
import { getCollection } from 'astro:content';
import TutorialLayout from '../../layouts/TutorialLayout.astro';
import SeriesLayout from '../../layouts/SeriesLayout.astro';
import { getSeriesNavigation } from '../../lib/tutorials';

export async function getStaticPaths() {
  const tutorials = await getCollection('tutorials');
  return tutorials.map(tutorial => ({
    params: { slug: tutorial.slug },
    props: { tutorial },
  }));
}

const { tutorial } = Astro.props;
const { Content, headings } = await tutorial.render();

const seriesNav = await getSeriesNavigation(tutorial);
const Layout = seriesNav ? SeriesLayout : TutorialLayout;
---

<Layout
  title={tutorial.data.title}
  tutorial={tutorial}
  headings={headings}
  seriesNav={seriesNav}
>
  <Content />
</Layout>
